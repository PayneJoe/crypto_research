p = 4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559787

## Fp
Fp = GF(p)

########## Fp2 = Fp[X] / X^2 - alpha
## alpha = -1
d = 2
alpha = Fp(-1)
X = Fp['X'].gen()
pol2 = X ** d - alpha
assert(pol2.is_irreducible() == True)
Fp2 = GF(p ** d, 'u', modulus = pol2)
u = Fp2.gen()


## addition/substraction/multiplication/squaring
a = Fp2([
    2600519326539830558472509080271623368201766255277844531820768498222883817097811802988058217645752353302064093108850,
    3773918811240353028132708301698978168292380996566825694015677018101572110945786257480550114727558899711214737389297
])
b = Fp2([
    1072443203470471287375910660069807232650870352399015460462646395708207704323743652585202041826373844903210482208294,
    1937629177128637437019849210056487608119787191192930938568869938274614678466303024924457365106197793056188608524635
])
c = a + b
d = a - b
e = a * b
f = a * a
print('a + b = {}'.format(c))
print('a - b = {}'.format(d))
print('a * b = {}'.format(a * b))
print('a^2 = {}'.format(f))

## sqrt/division
a = Fp2([
    1693922075044290799586349725248644656585209853597348488898111566020612993050193363830654421807029150461916786662716,
    1307028274328876631654407493870275350503167406226236850937444676077287355413536344735451832959901439122302764659852
])
b = Fp2([
    1072443203470471287375910660069807232650870352399015460462646395708207704323743652585202041826373844903210482208294,
    1937629177128637437019849210056487608119787191192930938568869938274614678466303024924457365106197793056188608524635
])
g = a.sqrt()
h = a / b
print('sqrt(a) = {}'.format(g))
print('a/b = {}'.format(h))
      
## frobenius map
a = Fp2([
    1693922075044290799586349725248644656585209853597348488898111566020612993050193363830654421807029150461916786662716,
    1307028274328876631654407493870275350503167406226236850937444676077287355413536344735451832959901439122302764659852
])
for i in range(1, 2):
    print('phi(a) = {}'.format(a ** (p ** i)))